<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Pattern Matching and Alignment" href="pattern_matching_alignment.html" /><link rel="prev" title="Configuration" href="configuration.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Creating Drivers for Instruments - Secbench 2025.04 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom_basicstrap.css?v=b94b5d1c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Secbench 2025.04 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Secbench 2025.04 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Learning Secbench</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Learning Secbench</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bench_and_discovery.html">Bench and Device Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="storage_walkthrough.html">Secbench Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_scopes.html">Using Scopes</a></li>
<li class="toctree-l2"><a class="reference internal" href="acquisition_and_storage.html">Example Side-Channel Acquisition</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Creating Drivers for Instruments</a></li>
<li class="toctree-l2"><a class="reference internal" href="pattern_matching_alignment.html">Pattern Matching and Alignment</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api-reference/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api-reference/api.html">Module: <code class="docutils literal notranslate"><span class="pre">secbench.api</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-reference/storage.html">Module: <code class="docutils literal notranslate"><span class="pre">secbench.storage</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-reference/processing.html">Module: <code class="docutils literal notranslate"><span class="pre">secbench.processing</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-reference/picoscope.html">Module: <code class="docutils literal notranslate"><span class="pre">secbench.picoscope</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/instrument_tutorial.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="creating-drivers-for-instruments">
<span id="sec-custom-instrument"></span><h1>Creating Drivers for Instruments<a class="headerlink" href="#creating-drivers-for-instruments" title="Link to this heading">¶</a></h1>
<p>In this tutorial, we describe how to integrate your own instruments (scopes, pulsers, AFGs, 3-axis tables) with <a class="reference internal" href="../api-reference/api.html#module-secbench.api" title="secbench.api"><code class="xref py py-mod docutils literal notranslate"><span class="pre">secbench.api</span></code></a>.
Here, we take the example of <a class="reference internal" href="../api-reference/api.html#secbench.api.instrument.Scope" title="secbench.api.instrument.Scope"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scope</span></code></a> implementation, but the approach would be the same with other type of instruments.</p>
<section id="step-1-implement-an-abstract-instrument">
<h2>Step 1: Implement an Abstract Instrument<a class="headerlink" href="#step-1-implement-an-abstract-instrument" title="Link to this heading">¶</a></h2>
<p>If your instrument is based on commands (SCPI or similar), we highly recommend
that you inherit <a class="reference internal" href="../api-reference/api.html#secbench.api.instrument.InstrumentMixin" title="secbench.api.instrument.InstrumentMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstrumentMixin</span></code></a> class and implement
its functions. This mixin exposes the functions of the communication backend to
the current hardware, such as <code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code>.</p>
<p>Then, you must implement the abstract methods of the <a class="reference internal" href="../api-reference/api.html#secbench.api.instrument.Scope" title="secbench.api.instrument.Scope"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scope</span></code></a> class.
Here’s how the implementation could look like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">secbench.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">InstrumentMixin</span><span class="p">,</span> <span class="n">Backend</span><span class="p">,</span> <span class="n">UserConfig</span><span class="p">,</span> <span class="n">Discoverable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">secbench.api.instrument</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scope</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MySuperInstrument</span><span class="p">(</span><span class="n">InstrumentMixin</span><span class="p">,</span> <span class="n">Scope</span><span class="p">):</span>

    <span class="c1"># ===</span>
    <span class="c1"># InstrumentMixin</span>
    <span class="c1"># ===</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">backend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_backend</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">backend</span><span class="p">:</span> <span class="n">Backend</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">UserConfig</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">has_error</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pop_next_error</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="c1"># ===</span>
    <span class="c1"># Scope Interface</span>
    <span class="c1"># ===</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;my super instrument&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">horizontal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HORIZONTAL:INTERVAL </span><span class="si">{</span><span class="n">interval</span><span class="si">:</span><span class="s2">E</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HORIZONTAL:SAMPLES </span><span class="si">{</span><span class="n">samples</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">horizontal_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;HORIZONTAL:DURATION?&quot;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
            <span class="n">busy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;BUSY?&quot;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">busy</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">InstrumentError</span><span class="p">(</span><span class="s2">&quot;Reached timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_wait_auto</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="c1"># Number of seconds to wait</span>
        <span class="n">ttw</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait</span><span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">ttw</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>

    <span class="c1"># ... Other methods ...</span>
</pre></div>
</div>
<p>Secbench also defines different mixin classes that can be implemented by your instrument, depending on its specific features such as:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">WriteManyMixin</span></code>: interesting to implement if your instrument supports the reception of multiple SCPI commands at the same time.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">HasSetupStorage</span></code>: defines methods that can load/store the instrument setup.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">HasWaveformStorage</span></code>: some scopes can store waveforms locally, implement this class if you want to retrieve them.</p></li>
</ul>
</section>
<section id="step-2-make-your-instrument-discoverable">
<h2>Step 2: Make your Instrument Discoverable<a class="headerlink" href="#step-2-make-your-instrument-discoverable" title="Link to this heading">¶</a></h2>
<p>The secbench framework already proposes different backends to work with
instruments. The idea is to subclass the “backend-agnostic” instrument
<code class="docutils literal notranslate"><span class="pre">MySuperInstrument</span></code> and inherit some mixin what will make it discoverable with
specific communication backends. The following code shows how to make your
device discoverable over serial communication, or VISA backend (e.g. GPIB,
RS232, USB, Ethernet).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is also possible to manually implement the <a class="reference internal" href="../api-reference/api.html#secbench.api.Discoverable" title="secbench.api.Discoverable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Discoverable</span></code></a>
interface. This would require slightly more code.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">secbench.api.backend</span><span class="w"> </span><span class="kn">import</span> <span class="n">SerialDiscoverableMixin</span><span class="p">,</span> <span class="n">PyVisaDiscoverableMixin</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MySuperInstrumentOverSerial</span><span class="p">(</span><span class="n">SerialDiscoverableMixin</span><span class="p">,</span> <span class="n">Discoverable</span><span class="p">,</span> <span class="n">MySuperInstrument</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_match_serial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">idn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">idn</span> <span class="o">==</span> <span class="s2">&quot;XXAABB&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MySuperInstrumentOverPyVisa</span><span class="p">(</span><span class="n">PyVisaDiscoverableMixin</span><span class="p">,</span> <span class="n">Discoverable</span><span class="p">,</span> <span class="n">MySuperInstrument</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_pyvisa_match_id</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">rm</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;INSTR:FOO&quot;</span>
</pre></div>
</div>
<p>Your scope is now discoverable. You should be able to obtain your instrument
with the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">secbench.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_bench</span>

<span class="n">bench</span> <span class="o">=</span> <span class="n">get_bench</span><span class="p">()</span>

<span class="n">my_scope</span> <span class="o">=</span> <span class="n">bench</span><span class="o">.</span><span class="n">get_scope</span><span class="p">()</span>

<span class="c1"># More specific requests:</span>
<span class="n">my_scope</span> <span class="o">=</span> <span class="n">bench</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">MySuperInstrument</span><span class="p">)</span>
<span class="n">my_scope</span> <span class="o">=</span> <span class="n">bench</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">MySuperInstrumentOverSerial</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-a-new-communication-backend">
<h2>Adding a new Communication Backend<a class="headerlink" href="#adding-a-new-communication-backend" title="Link to this heading">¶</a></h2>
<p>If your communication backend is not supported, you can implement your own by inheriting from <code class="xref py py-class docutils literal notranslate"><span class="pre">secbench.api.Backend</span></code>.
Currently supported backends for instruments are implemented by the following classes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api-reference/api.html#secbench.api.backend.USBTMCBackend" title="secbench.api.backend.USBTMCBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">USBTMCBackend</span></code></a></p></li>
<li><p><a class="reference internal" href="../api-reference/api.html#secbench.api.backend.PyVisaBackend" title="secbench.api.backend.PyVisaBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyVisaBackend</span></code></a></p></li>
<li><p><a class="reference internal" href="../api-reference/api.html#secbench.api.backend.VXIBackend" title="secbench.api.backend.VXIBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">VXIBackend</span></code></a></p></li>
<li><p><a class="reference internal" href="../api-reference/api.html#secbench.api.backend.SerialBackend" title="secbench.api.backend.SerialBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">SerialBackend</span></code></a></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">secbench.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">Backend</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyAwesomeBackend</span><span class="p">(</span><span class="n">Backend</span><span class="p">):</span>

    <span class="c1"># ===</span>
    <span class="c1"># Backend interface</span>
    <span class="c1"># ===</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secs</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set timeout for blocking operations. (optional)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="c1"># ... Other methods ...</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MyAwesomeBackendDiscoverableMixin</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">discover</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">hw_info</span><span class="p">:</span> <span class="n">HardwareInfo</span><span class="p">):</span>
        <span class="c1"># Implementation of discover for this class.</span>
        <span class="o">...</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">hardware_info</span><span class="p">:</span> <span class="n">HardwareInfo</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="n">MyAwesomeBackend</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MySuperInstrumentOverMyAwesomeBackend</span><span class="p">(</span><span class="n">MyAwesomeBackendDiscoverableMixin</span><span class="p">,</span> <span class="n">Discoverable</span><span class="p">,</span> <span class="n">MySuperInstrument</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can load your scope with this</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">MyAwesomeBackend</span><span class="p">(</span><span class="s2">&quot;FOO&quot;</span><span class="p">)</span>
<span class="n">scope</span> <span class="o">=</span> <span class="n">MySuperInstrument</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>

<span class="c1"># Or discover it from the bench</span>
<span class="n">bench</span> <span class="o">=</span> <span class="n">get_bench</span><span class="p">()</span>
<span class="n">scope</span> <span class="o">=</span> <span class="n">bench</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Scope</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pattern_matching_alignment.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Pattern Matching and Alignment</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="configuration.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Configuration</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2017-2025, CEA-LETI
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/CEA-Leti/secbench" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Creating Drivers for Instruments</a><ul>
<li><a class="reference internal" href="#step-1-implement-an-abstract-instrument">Step 1: Implement an Abstract Instrument</a></li>
<li><a class="reference internal" href="#step-2-make-your-instrument-discoverable">Step 2: Make your Instrument Discoverable</a></li>
<li><a class="reference internal" href="#adding-a-new-communication-backend">Adding a new Communication Backend</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5b977ab4"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>